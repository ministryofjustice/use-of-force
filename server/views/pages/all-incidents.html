{% extends "../partials/incidentPage.html" %} 
{% from "govuk/components/button/macro.njk" import govukButton %} 
{% from "govuk/components/table/macro.njk" import govukTable %} 

{% block tabContent %}
<section class="govuk-tabs__panel" id="past-day">
{% if awaitingReports.length %}
<table class="govuk-table reviewer-incidents" data-qa="incidents-todo">
  <caption class="govuk-table__caption govuk-heading-m">
    Not completed
  </caption>

  <thead class="govuk-table__head">
    <tr class="govuk-table__row">
      <th class="govuk-table__header date" scope="col">Date</th>
      <th class="govuk-table__header prisoner" scope="col">Prisoner</th>
      <th class="govuk-table__header prisonNo" scope="col">Prison no.</th>
      <th class="govuk-table__header reporter" scope="col">Reporter</th>
      <th class="govuk-table__header report" scope="col"></th>
      {% if user.isCoordinator %}      
      <th class="govuk-table__header delete" scope="col"></th>
      {% endif %}      
      <th class="govuk-table__header overdue" scope="col"></th>
    </tr>
  </thead>

  <tbody class="govuk-table__body">
      {% for report in awaitingReports %}
      <tr class="govuk-table__row">
          <td class="govuk-table__cell govuk-!-padding-top-3">{{report.incidentdate | formatDate('D MMMM YYYY')}}</td>
          <td class="govuk-table__cell govuk-!-padding-top-3">{{report.offenderName}}</td>
          <td class="govuk-table__cell govuk-!-padding-top-3">{{report.offenderNo}}</td>
          <td class="govuk-table__cell govuk-!-padding-top-3">{{report.staffMemberName}}</td>
          <td class="govuk-table__cell govuk-!-padding-top-3">
            <a
              href="/{{ report.id }}/view-statements"
              draggable="false"
              class="govuk-link" 
            >
              View incident
            </a>
          </td>
          {% if user.isCoordinator %}
          <td class="govuk-table__cell">
              {{
                govukButton({
                  text: 'Delete',
                  name: 'delete',
                  href: '/coordinator/report/' + report.id + '/confirm-delete',
                  classes: 'govuk-button govuk-button--secondary',
                  attributes: { 'data-qa': 'continue' }
                })
              }}
          </td>
          {% endif %}  
          <td class="govuk-table__cell">
            {% if report.isOverdue %}
              <span data-qa="overdue" class="govuk-tag moj-tag--red govuk-!-margin-top-1">OVERDUE</span>
            {% endif %}
          </td>
      </tr>  
      {% endfor %}
  </tbody>
</table>
{% else %}
<h3 class="govuk-heading-m">Not completed</h3>
<p class="govuk-body" data-qa="no-incidents-todo">There are no incomplete incidents</p>
{% endif %}

{% if completedReports.length %}
<table class="govuk-table reviewer-incidents" data-qa="incidents-complete">
  <caption class="govuk-table__caption govuk-heading-m">
    Completed
  </caption>

  <thead class="govuk-table__head">
    <tr class="govuk-table__row">
        <th class="govuk-table__header date" scope="col">Date</th>
        <th class="govuk-table__header prisoner" scope="col">Prisoner</th>
        <th class="govuk-table__header prisonNo" scope="col">Prison no.</th>
        <th class="govuk-table__header reporter" scope="col">Reporter</th>
        <th class="govuk-table__header report" scope="col"></th>
        {% if user.isCoordinator %}      
        <th class="govuk-table__header delete" scope="col"></th>
        {% endif %}      
        <th class="govuk-table__header overdue" scope="col"></th>
      </tr>
  </thead>

  <tbody class="govuk-table__body">
      {% for report in completedReports %}
      <tr class="govuk-table__row">
        <td class="govuk-table__cell govuk-!-padding-top-3">{{report.incidentdate | formatDate('D MMMM YYYY')}}</td>
        <td class="govuk-table__cell govuk-!-padding-top-3">{{report.offenderName}}</td>
        <td class="govuk-table__cell govuk-!-padding-top-3">{{report.offenderNo}}</td>
        <td class="govuk-table__cell govuk-!-padding-top-3">{{report.staffMemberName}}</td>
        <td class="govuk-table__cell govuk-!-padding-top-3">
          <a
            href="/{{ report.id }}/view-statements"
            draggable="false"
            class="govuk-link" 
          >
            View incident
          </a>
        </td>
        {% if user.isCoordinator %}
        <td class="govuk-table__cell">
            {{
              govukButton({
                text: 'Delete',
                name: 'delete',
                href: '/coordinator/report/' + report.id + '/confirm-delete',
                classes: 'govuk-button govuk-button--secondary',
                attributes: { 'data-qa': 'continue' }
              })
            }}
        </td>
        {% endif %}  
        <td class="govuk-table__cell">
        </td>
      </tr>  
      {% endfor %}

  </tbody>
</table>
{% else %}
<h3 class="govuk-heading-m">Not completed</h3>
<p class="govuk-body" data-qa="no-incidents-complete">There are no completed incidents</p>
{% endif %}
</section>
{% endblock %}
